# Детекция людей на видео

Проект для автоматического обнаружения и отслеживания людей на видеопотоке с использованием нейросетевых моделей Yolo и Faster RCNN.

## Руководство по эксплуатации

* установите окружение 

`pip install -r requirements.txt`

* из корневой папки запустите main.py . Файл для распознования должен лежать в папке `source` с именем `crowd.mp4`

```
python main.py
```

* Выберете модель (для выхода ввести `42`)
  * `1` - Yolo
  * `2` - Faster RCNN 

* результат будет сохранен в папке `result`/ выбранная модель/ . 

## Результаты

Были рассмотрены архитектуры  Yolo и Faster R-CNN. 

|Yolo| Faster R-CNN|
|:---|:---|
|Высокая скорость обработки (real-time), хороший баланс точности и производительности. Основная модель по умолчанию, подходит для большинства задач. Можно быстро испытать более легкую или более тяжелую модель в зависимости от задачи |Высокая точность детекции, особенно для мелких объектов. Удобна, когда важна максимальная точность, а скорость вторична.  |

Данные архитектуры предобучены и имеют высокие метрики детекции даже без дообучения. 



Результаты видны на изображении ниже. 

| YOLO                                                    | Faster RCNN                                                                 |
|:--------------------------------------------------------|:----------------------------------------------------------------------------|
| ![Метрики YOLO](result/yolo/metrics/freeze_metrics.png) | ![Метрики Faster RCNN](result/faster_rcnn/metrics/freeze_metrics.png "123") |

В проекте рассчитываются следующие метрики производительности и качества:

* FPS — средняя скорость инференса (кадров в секунду)

* Avg confidence — средняя уверенность детекций (0-1)

* Max people per frame — максимальное число людей в одном кадре

* Avg people per frame — среднее число людей на кадр

* Self-IoU over time — временная стабильность боксов (0-1)

| Yolo                                                                                                                                                                                    | Faster R-CNN                                                                                                                                                                         |
|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
 | Сильные стороны <br/> * Отличная скорость обработки <br/> * Стабильные детекции на переднем плане <br/> * Минимальное дрожание боксов <br/> * Хорошо работает с крупными объектами      | Сильные стороны <br/> * Высокая точность детекции <br/> * Хорошо работает с мелкими объектами <br/> * Высокий recall на заднем плане <br/> * Отличная стабильность (Self-IoU = 0.93) |
 | Слабые стороны <br/> * Плохо детектирует мелкие объекты на заднем плане <br/> * Пропускает людей в плотных сценах <br/> * Ограниченный recall на дальних дистанциях  | Слабые стороны <br/> * Очень низкая скорость (0.72 FPS) <br/> * Заметное дрожание боксов в реальном времени <br/> * Высокие требования к ресурсам                                    |
     

## Рекомендации 

* Выбор оптимальной модели в зависимости от задачи
* Дообучить модель
* Улучшить качество видео

